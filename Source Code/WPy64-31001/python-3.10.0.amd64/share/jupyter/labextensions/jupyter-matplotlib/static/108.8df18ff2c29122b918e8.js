"use strict";(self.webpackChunkjupyter_matplotlib=self.webpackChunkjupyter_matplotlib||[]).push([[108],{686:(t,e,i)=>{i.r(e),i.d(e,{MODULE_NAME:()=>h.o,MODULE_VERSION:()=>h.Y,MPLCanvasModel:()=>l,MPLCanvasView:()=>r,ToolbarModel:()=>d,ToolbarView:()=>_});var s=i(335);function o(t,e){const i=e.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}}function a(t){return Object.keys(t).reduce(((e,i)=>("object"!=typeof t[i]&&(e[i]=t[i]),e)),{})}function n(t){const e=t.getContext("2d");if(null===e)throw"Could not create 2d context.";return e}var h=i(657);class l extends s.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"MPLCanvasModel",_view_name:"MPLCanvasView",_model_module:"jupyter-matplotlib",_view_module:"jupyter-matplotlib",_model_module_version:"^"+h.Y,_view_module_version:"^"+h.Y,header_visible:!0,footer_visible:!0,toolbar:null,toolbar_visible:!0,toolbar_position:"horizontal",resizable:!0,capture_scroll:!1,_data_url:null,_width:0,_height:0,_figure_label:"Figure",_message:"",_cursor:"pointer",_image_mode:"full",_rubberband_x:0,_rubberband_y:0,_rubberband_width:0,_rubberband_height:0})}initialize(t,e){super.initialize(t,e),this.offscreen_canvas=document.createElement("canvas"),this.offscreen_context=n(this.offscreen_canvas);const i=this.offscreen_context,s=i.backingStorePixelRatio||i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||1;this.requested_size=null,this.resize_requested=!1,this.ratio=(window.devicePixelRatio||1)/s,this.resize_canvas(this.get("_width"),this.get("_height")),this._init_image(),this.on("msg:custom",this.on_comm_message.bind(this)),this.on("change:resizable",(()=>{this._for_each_view((t=>{t.update_canvas()}))})),this.on("comm_live_update",this.update_disabled.bind(this)),this.update_disabled(),this.send_initialization_message()}get disabled(){return!this.comm_live}update_disabled(){this.set("resizable",!this.disabled)}sync(t,e,i={}){i.attrs&&delete i.attrs._data_url,super.sync(t,e,i)}send_message(t,e={}){e.type=t,this.send(e,{})}send_initialization_message(){1!==this.ratio&&(this.send_message("set_dpi_ratio",{dpi_ratio:this.ratio}),this.send_message("set_device_pixel_ratio",{device_pixel_ratio:this.ratio})),this.send_message("refresh"),this.send_message("send_image_mode"),this.send_message("initialized")}send_draw_message(){this.waiting_for_image||(this.waiting_for_image=!0,this.send_message("draw"))}handle_save(){const t=document.createElement("a");t.href=this.offscreen_canvas.toDataURL(),t.download=this.get("_figure_label")+".png",document.body.appendChild(t),t.click(),document.body.removeChild(t)}handle_resize(t){const e=t.size;this.resize_canvas(e[0],e[1]),this.offscreen_context.drawImage(this.image,0,0),this.resize_requested||this._for_each_view((t=>{t.resize_canvas(e[0],e[1])})),this.send_message("refresh"),this.resize_requested=!1,null!==this.requested_size&&(this.resize(this.requested_size[0],this.requested_size[1]),this.requested_size=null)}resize(t,e){t<=5||e<=5||(this._for_each_view((i=>{i.resize_canvas(t,e)})),this.resize_requested?this.requested_size=[t,e]:(this.resize_requested=!0,this.send_message("resize",{width:t,height:e})))}resize_canvas(t,e){this.offscreen_canvas.width=t*this.ratio,this.offscreen_canvas.height=e*this.ratio}handle_rubberband(t){let e=t.x0/this.ratio,i=(this.offscreen_canvas.height-t.y0)/this.ratio,s=t.x1/this.ratio,o=(this.offscreen_canvas.height-t.y1)/this.ratio;e=Math.floor(e)+.5,i=Math.floor(i)+.5,s=Math.floor(s)+.5,o=Math.floor(o)+.5,this.set("_rubberband_x",Math.min(e,s)),this.set("_rubberband_y",Math.min(i,o)),this.set("_rubberband_width",Math.abs(s-e)),this.set("_rubberband_height",Math.abs(o-i)),this.save_changes(),this._for_each_view((t=>{t.update_canvas()}))}handle_draw(t){this.send_draw_message()}handle_binary(t,e){const i=window.URL||window.webkitURL,s=new Uint8Array(e[0].buffer),o=new Blob([s],{type:"image/png"}),a=i.createObjectURL(o);this.image.src&&i.revokeObjectURL(this.image.src),this.image.src=a,this.set("_data_url",this.offscreen_canvas.toDataURL()),this.waiting_for_image=!1}handle_history_buttons(t){}handle_navigate_mode(t){}on_comm_message(t,e){const i=JSON.parse(t.data),s=i.type;let o;try{o=this["handle_"+s].bind(this)}catch(t){return void console.log("No handler for the '"+s+"' message type: ",i)}o&&o(i,e)}_init_image(){this.image=new Image,this.image.onload=()=>{"full"===this.get("_image_mode")&&this.offscreen_context.clearRect(0,0,this.offscreen_canvas.width,this.offscreen_canvas.height),this.offscreen_context.drawImage(this.image,0,0),this._for_each_view((t=>{t.update_canvas()}))};const t=this.get("_data_url");null!==t&&(this.image.src=t)}_for_each_view(t){for(const e in this.views)this.views[e].then((e=>{t(e)}))}remove(){this.send_message("closing")}}l.serializers=Object.assign(Object.assign({},s.DOMWidgetModel.serializers),{toolbar:{deserialize:s.unpack_models}});class r extends s.DOMWidgetView{render(){return this.resizing=!1,this.resize_handle_size=20,this.figure=document.createElement("div"),this.figure.classList.add("jupyter-matplotlib-figure","jupyter-widgets","widget-container","widget-box","widget-vbox"),this._init_header(),this._init_canvas(),this._init_footer(),this._resize_event=this.resize_event.bind(this),this._stop_resize_event=this.stop_resize_event.bind(this),window.addEventListener("mousemove",this._resize_event),window.addEventListener("mouseup",this._stop_resize_event),this.create_child_view(this.model.get("toolbar")).then((t=>{this.toolbar_view=t,this._update_toolbar_position(),this._update_header_visible(),this._update_footer_visible(),this._update_toolbar_visible(),this.model_events()}))}model_events(){this.model.on("change:header_visible",this._update_header_visible.bind(this)),this.model.on("change:footer_visible",this._update_footer_visible.bind(this)),this.model.on("change:toolbar_visible",this._update_toolbar_visible.bind(this)),this.model.on("change:toolbar_position",this._update_toolbar_position.bind(this)),this.model.on("change:_figure_label",this._update_figure_label.bind(this)),this.model.on("change:_message",this._update_message.bind(this)),this.model.on("change:_cursor",this._update_cursor.bind(this))}_update_header_visible(){this.header.style.display=this.model.get("header_visible")?"":"none"}_update_footer_visible(){this.footer.style.display=this.model.get("footer_visible")?"":"none"}_update_toolbar_visible(){this.toolbar_view.el.style.display=this.model.get("toolbar_visible")?"":"none"}_update_toolbar_position(){const t=this.model.get("toolbar_position");"top"===t||"bottom"===t?(this.el.classList.add("jupyter-widgets","widget-container","widget-box","widget-vbox","jupyter-matplotlib"),this.model.get("toolbar").set("orientation","horizontal"),this.clear(),"top"===t?(this.el.appendChild(this.toolbar_view.el),this.el.appendChild(this.figure)):(this.el.appendChild(this.figure),this.el.appendChild(this.toolbar_view.el))):(this.el.classList.add("jupyter-widgets","widget-container","widget-box","widget-hbox","jupyter-matplotlib"),this.model.get("toolbar").set("orientation","vertical"),this.clear(),"left"===t?(this.el.appendChild(this.toolbar_view.el),this.el.appendChild(this.figure)):(this.el.appendChild(this.figure),this.el.appendChild(this.toolbar_view.el)))}clear(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)}_init_header(){this.header=document.createElement("div"),this.header.style.textAlign="center",this.header.classList.add("jupyter-widgets","widget-label"),this._update_figure_label(),this.figure.appendChild(this.header)}_update_figure_label(){this.header.textContent=this.model.get("_figure_label")}_init_canvas(){const t=document.createElement("div");t.classList.add("jupyter-widgets","jupyter-matplotlib-canvas-container"),this.figure.appendChild(t);const e=this.canvas_div=document.createElement("div");e.style.position="relative",e.style.clear="both",e.classList.add("jupyter-widgets","jupyter-matplotlib-canvas-div"),e.addEventListener("keydown",this.key_event("key_press")),e.addEventListener("keyup",this.key_event("key_release")),e.setAttribute("tabindex","0"),t.appendChild(e);const i=this.canvas=document.createElement("canvas");i.style.display="block",i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.zIndex="0",this.context=n(i);const s=this.top_canvas=document.createElement("canvas");s.style.display="block",s.style.position="absolute",s.style.left="0",s.style.top="0",s.style.zIndex="1",s.addEventListener("mousedown",this.mouse_event("button_press")),s.addEventListener("mouseup",this.mouse_event("button_release")),s.addEventListener("mousemove",this.mouse_event("motion_notify")),s.addEventListener("mouseenter",this.mouse_event("figure_enter")),s.addEventListener("mouseleave",this.mouse_event("figure_leave")),s.addEventListener("wheel",this.mouse_event("scroll")),e.appendChild(i),e.appendChild(s),this.top_context=n(s),this.top_context.strokeStyle="rgba(0, 0, 0, 255)",this.top_canvas.addEventListener("contextmenu",(t=>(t.preventDefault(),t.stopPropagation(),!1))),this.resize_canvas(this.model.get("_width"),this.model.get("_height")),this.update_canvas()}update_canvas(){if(0!==this.canvas.width&&0!==this.canvas.height){if(this.top_context.save(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.drawImage(this.model.offscreen_canvas,0,0),this.top_context.clearRect(0,0,this.top_canvas.width,this.top_canvas.height),0!==this.model.get("_rubberband_width")&&0!==this.model.get("_rubberband_height")&&(this.top_context.strokeStyle="gray",this.top_context.lineWidth=1,this.top_context.shadowColor="black",this.top_context.shadowBlur=2,this.top_context.shadowOffsetX=1,this.top_context.shadowOffsetY=1,this.top_context.strokeRect(this.model.get("_rubberband_x"),this.model.get("_rubberband_y"),this.model.get("_rubberband_width"),this.model.get("_rubberband_height"))),this.model.get("resizable")){const t=this.top_context.createLinearGradient(this.top_canvas.width-this.resize_handle_size,this.top_canvas.height-this.resize_handle_size,this.top_canvas.width,this.top_canvas.height);t.addColorStop(0,"white"),t.addColorStop(1,"black"),this.top_context.fillStyle=t,this.top_context.strokeStyle="gray",this.top_context.globalAlpha=.3,this.top_context.beginPath(),this.top_context.moveTo(this.top_canvas.width,this.top_canvas.height),this.top_context.lineTo(this.top_canvas.width,this.top_canvas.height-this.resize_handle_size),this.top_context.lineTo(this.top_canvas.width-this.resize_handle_size,this.top_canvas.height),this.top_context.closePath(),this.top_context.fill(),this.top_context.stroke()}this.top_context.restore()}}_update_cursor(){this.top_canvas.style.cursor=this.model.get("_cursor")}_init_footer(){this.footer=document.createElement("div"),this.footer.style.textAlign="center",this.footer.classList.add("jupyter-widgets","widget-label"),this._update_message(),this.figure.appendChild(this.footer)}_update_message(){this.footer.textContent=this.model.get("_message")}resize_canvas(t,e){this.canvas.setAttribute("width",""+t*this.model.ratio),this.canvas.setAttribute("height",""+e*this.model.ratio),this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.top_canvas.setAttribute("width",String(t)),this.top_canvas.setAttribute("height",String(e)),this.canvas_div.style.width=t+"px",this.canvas_div.style.height=e+"px",this.update_canvas()}mouse_event(t){let e=0;return i=>{const s=o(i,this.top_canvas);if("scroll"===t&&(i.data="scroll",i.deltaY<0?i.step=1:i.step=-1,this.model.get("capture_scroll")&&i.preventDefault()),"button_press"===t){if(s.x>=this.top_canvas.width-this.resize_handle_size&&s.y>=this.top_canvas.height-this.resize_handle_size&&this.model.get("resizable"))return void(this.resizing=!0);this.canvas.focus(),this.canvas_div.focus()}if(!this.resizing&&("motion_notify"===t&&(s.x>=this.top_canvas.width-this.resize_handle_size&&s.y>=this.top_canvas.height-this.resize_handle_size?this.top_canvas.style.cursor="nw-resize":this.top_canvas.style.cursor=this.model.get("_cursor")),Date.now()>e+16)){e=Date.now();const o=s.x*this.model.ratio,n=s.y*this.model.ratio;this.model.send_message(t,{x:o,y:n,button:i.button,step:i.step,guiEvent:a(i)})}}}resize_event(t){if(this.resizing){const e=o(t,this.top_canvas);this.model.resize(e.x,e.y)}}stop_resize_event(){this.resizing=!1}key_event(t){return e=>{if(e.stopPropagation(),e.preventDefault(),"key_press"===t){if(e.key===this._key)return;this._key=e.key}"key_release"===t&&(this._key=null);let i="";return e.ctrlKey&&"Control"!==e.key?i+="ctrl+":e.altKey&&"Alt"!==e.key?i+="alt+":e.shiftKey&&"Shift"!==e.key&&(i+="shift+"),i+="k"+e.key,this.model.send_message(t,{key:i,guiEvent:a(e)}),!1}}remove(){window.removeEventListener("mousemove",this._resize_event),window.removeEventListener("mouseup",this._stop_resize_event)}}class d extends s.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"ToolbarModel",_view_name:"ToolbarView",_model_module:"jupyter-matplotlib",_view_module:"jupyter-matplotlib",_model_module_version:"^"+h.Y,_view_module_version:"^"+h.Y,toolitems:[],orientation:"vertical",button_style:"",collapsed:!0,_current_action:""})}}class _ extends s.DOMWidgetView{initialize(t){super.initialize(t),this.on("comm_live_update",this.update_disabled.bind(this))}render(){this.el.classList.add("jupyter-widgets","jupyter-matplotlib-toolbar","widget-container","widget-box"),this.create_toolbar(),this.model_events()}create_toolbar(){const t=this.model.get("toolitems");this.toggle_button=document.createElement("button"),this.toggle_button.classList.add("jupyter-matplotlib-button","jupyter-widgets","jupyter-button"),this.toggle_button.setAttribute("href","#"),this.toggle_button.setAttribute("title","Toggle Interaction"),this.toggle_button.style.outline="none",this.toggle_button.addEventListener("click",(()=>{this.model.set("collapsed",!this.model.get("collapsed")),this.model.save_changes()}));const e=document.createElement("i");e.classList.add("center","fa","fa-fw","fa-bars"),this.toggle_button.appendChild(e),this.el.appendChild(this.toggle_button),this.toolbar=document.createElement("div"),this.toolbar.classList.add("widget-container","widget-box"),this.el.appendChild(this.toolbar),this.buttons={toggle_button:this.toggle_button};for(const e in t){const i=t[e][0],s=t[e][1],o=t[e][2],a=t[e][3];if(!i)continue;const n=document.createElement("button");n.classList.add("jupyter-matplotlib-button","jupyter-widgets","jupyter-button"),n.setAttribute("href","#"),n.setAttribute("title",s),n.style.outline="none",n.addEventListener("click",this.toolbar_button_onclick(a));const h=document.createElement("i");h.classList.add("center","fa","fa-fw","fa-"+o),n.appendChild(h),this.buttons[a]=n,this.toolbar.appendChild(n)}this.set_orientation(this.el),this.set_orientation(this.toolbar),this.set_buttons_style(),this.update_disabled()}get disabled(){return!this.model.comm_live}update_disabled(){this.toggle_button.disabled=this.disabled,this.disabled&&(this.toolbar.style.display="none")}set_orientation(t){"vertical"===this.model.get("orientation")?(t.classList.remove("widget-hbox"),t.classList.add("widget-vbox")):(t.classList.add("widget-hbox"),t.classList.remove("widget-vbox"))}toolbar_button_onclick(t){return e=>{"pan"!==t&&"zoom"!==t||(this.model.get("_current_action")===t?this.model.set("_current_action",""):this.model.set("_current_action",t),this.model.save_changes()),this.send({type:"toolbar_button",name:t})}}set_buttons_style(){const t={primary:["mod-primary"],success:["mod-success"],info:["mod-info"],warning:["mod-warning"],danger:["mod-danger"]};for(const e in this.buttons){const i=this.buttons[e];for(const e in t)i.classList.remove(t[e]);i.classList.remove("mod-active");const s=this.model.get("button_style");""!==s&&i.classList.add(t[s]),e===this.model.get("_current_action")&&i.classList.add("mod-active")}}update_collapsed(){this.toolbar.style.display=this.model.get("collapsed")?"":"none"}model_events(){this.model.on("change:orientation",this.update_orientation.bind(this)),this.model.on_some_change(["button_style","_current_action"],this.set_buttons_style,this),this.model.on("change:collapsed",this.update_collapsed.bind(this))}update_orientation(){this.set_orientation(this.el),this.set_orientation(this.toolbar)}}}}]);